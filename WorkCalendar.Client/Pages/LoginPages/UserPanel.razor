
@page "/UserPanel"
@layout MainLayout
@using Models
@using Microsoft.AspNetCore.Authorization
@using Models.DatabaseModels
@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@attribute [Authorize]
@inject NavigationManager navigationManager

<NotAuthorized>
    @{
        navigationManager.NavigateTo("login");
    }
</NotAuthorized>

<PageTitle>UserPanelLogin</PageTitle>
<label for="username">username</label> 
<label for="username">@currentUser.Login</label>
<br />
<label for="password">password</label> 
<label for="password">@currentUser.Password</label>
<br />

<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>
<br />
<br />
<br />
<br />
<br />
<br /><br />
<br />
<br />
<br />
<br />


<br />
<br /><br />
<br />
<br />
    <table class="table">
        <thead>
            <tr>
                <th>Data</th>
                <th>Czas logowania</th>
                <th>Ip</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var loginHistory in userLoginHistory)
        {
                                <tr>
                                            <td>@loginHistory.LoginDate</td>
                                            <td>@loginHistory.Duration</td>
                                            <td>@loginHistory.UserIp</td>
                                </tr>
        }
        </tbody>
    </table>



@code {
   User currentUser = new User();
    List<UserLogInHistory> userLoginHistory = new List<UserLogInHistory>();


    private int currentCount = 0;

    private void IncrementCount()
    {
        currentUser.Login = "hej";
        currentUser.Password = "MyNewPw";
        var history = new UserLogInHistory()
            {
                LoginDate = DateTime.Now,
                Duration = DateTime.MinValue,
                UserIp = "52.525.626.727"
            };

        var history2 = new UserLogInHistory()
            {
                LoginDate = DateTime.Now,
                Duration = DateTime.MinValue,
                UserIp = "709.25.66.117"
            };

        var history3 = new UserLogInHistory()
            {
                LoginDate = DateTime.Now,
                Duration = DateTime.MinValue,
                UserIp = "02.15.626.76"
            };
            userLoginHistory.Add(history);
        userLoginHistory.Add(history2);
        userLoginHistory.Add(history3);
    }
}
